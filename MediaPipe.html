<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/holistic/holistic.js" crossorigin="anonymous"></script>
  <style>
  .input_video {
    display: none;
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    &.selfie {
      transform: scale(-1, 1);
    }
  }
  .controls {
    justify-content: left;
    align-items: left;
    vertical-align: top;
  }
  .canvas_container {
    display:flex;
    justify-content: center;
    align-items: center;
    vertical-align: top;
  }
  .output_canvas {
    max-width: 100%;
    display: block;
    position: relative;
    left: 0;
    top: 0;
  }
  </style>
</head>

<script type="module" src="MediaPipe.js" crossorigin="anonymous">
</script>
<script type="module">
  import {setIsDrawPoseKeypointsCheckbox,
          setIsDrawFaceKeypointsCheckbox,
          setIsDrawHandsKeypointsCheckbox,
          setIsShowPoseTableCheckbox,
          setIsShowFaceTableCheckbox,
          setIsShowHandsTableCheckbox,
          setMpModelComplexity,
          setMpSmoothLandmarks,
          setMpEnableSegmentation,
          setMpSmoothSegmentation,
          setMpRefineFaceLandmarks,
          setMpMinDetectionConfidence,
          setMpMinTrackingConfidence,
          setMpSelfieMode,
  } from "./MediaPipe.js";
  window.setIsDrawPoseKeypointsCheckbox = setIsDrawPoseKeypointsCheckbox;
  window.setIsDrawFaceKeypointsCheckbox = setIsDrawFaceKeypointsCheckbox;
  window.setIsDrawHandsKeypointsCheckbox = setIsDrawHandsKeypointsCheckbox;
  window.setIsShowPoseTableCheckbox = setIsShowPoseTableCheckbox;
  window.setIsShowFaceTableCheckbox = setIsShowFaceTableCheckbox;
  window.setIsShowHandsTableCheckbox = setIsShowHandsTableCheckbox;
  window.setMpModelComplexity = setMpModelComplexity;
  window.setMpSmoothLandmarks = setMpSmoothLandmarks;
  window.setMpEnableSegmentation = setMpEnableSegmentation;
  window.setMpSmoothSegmentation = setMpSmoothSegmentation;
  window.setMpRefineFaceLandmarks = setMpRefineFaceLandmarks;
  window.setMpMinDetectionConfidence = setMpMinDetectionConfidence;
  window.setMpMinTrackingConfidence = setMpMinTrackingConfidence;
  window.setMpSelfieMode = setMpSelfieMode;
</script>

<body>
  <H1>MediaPipe Demo</H1>
  <p>Modified from https://github.com/google/mediapipe/blob/master/docs/solutions/holistic.md</p>
  <div>
  <table>
    <tr>
      <td class="controls">
        <h3>MediaPipe Holistic Model Options</h2>
        <table>
          <tr><td>Model Complexity</td><td><input type="number" value="0", id="mpModelComplexity" min="0" max="2" step="1" onChange="setMpModelComplexity(this.value);"/></td></tr>
          <tr><td>Smooth Landmarks</td><td><input type="checkbox"checked="true", id="mpSmoothLandmarks" onChange="setMpSmoothLandmarks(this.checked);"/></td></tr>
          <tr><td>Enable Segmentation</td><td><input type="checkbox" id="mpEnableSegmentation" onChange="setMpEnableSegmentation(this.checked);"/></td></tr>
          <tr><td>Smooth Segmentation</td><td><input type="checkbox" id="mpSmoothSegmentation" onChange="setMpSmoothSegmentation(this.checked);"/></td></tr>
          <tr><td>Refine Face Landmarks</td><td><input type="checkbox" id="mpRefineFaceLandmarks" onChange="setMpRefineFaceLandmarks(this.checked);"/></td></tr>
          <tr><td>Min Detection Confidence</td><td><input type="number" value="0.5", id="mpMinDetectionConfidence" min="0.0" max="1.0" step="0.1" onChange="setMpMinDetectionConfidence(this.value);"/></td></tr>
          <tr><td>Min Tracking Confidence</td><td><input type="number" value="0.5", id="mpMinTrackingConfidence" min="0.0" max="1.0" step="0.1" onChange="setMpMinTrackingConfidence(this.value);"/></td></tr>
          <tr><td>Selfie Mode</td><td><input type="checkbox" checked="true", id="mpSelfieMode" onChange="setMpSelfieMode(this.checked);"/></td></tr>
        </table>
        <p></p>
        <h3>Display Options</h2>
        <table>
          <tr>
            <td></td>
            <td>pose</td>
            <td>hands</td>
            <td>face</td>
          </tr>
          <tr>
            <td align=right>Draw keypoints</td>
            <td><input type="checkbox" id="isDrawPoseKeypoints" onChange="setIsDrawPoseKeypointsCheckbox(this.checked);"/></td>
            <td><input type="checkbox" id="isDrawHandsKeypoints" onChange="setIsDrawHandsKeypointsCheckbox(this.checked);"/></td>
            <td><input type="checkbox" id="isDrawFaceKeypoints" onChange="setIsDrawFaceKeypointsCheckbox(this.checked);"/></td>
          </tr>
          <tr>
            <td align=right>Show table</td>
            <td><input type="checkbox" id="isShowPoseTable" onChange="setIsShowPoseTableCheckbox(this.checked);"/></td>
            <td><input type="checkbox" id="isShowHandsTable" onChange="setIsShowHandsTableCheckbox(this.checked);"/></td>
            <td><input type="checkbox" id="isShowFaceTable" onChange="setIsShowFaceTableCheckbox(this.checked);"/></td>
          </tr>
        </table>
        <h3>Frame rate</h3>
        <p id="frameRate">0 FPS</p>
      </td>
      <td class="canvas_container">
        <video class="input_video selfie"></video>
        <canvas class="output_canvas" width="640px" height="480px"></canvas>
      </td>
    </tr>
  </table>
  </div>
  <p id="keypoints"></p>
</body>
</html>

